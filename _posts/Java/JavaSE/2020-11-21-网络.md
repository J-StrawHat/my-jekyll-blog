---
title: ã€ŒJavaSEå­¦ä¹ ç¬”è®°08ã€ç½‘ç»œç¼–ç¨‹
author: JoyDee
categories: [Java, JavaSE]
tags: [JavaSE]
date: 2020-11-21 21:22:00 +0800
math: true
---

# Chapter 14. ç½‘ç»œç¼–ç¨‹

ç½‘ç»œç¼–ç¨‹ï¼Œå³ä½¿ç”¨ç¼–ç¨‹è¯­è¨€å®ç°å¤šå°è®¡ç®—æœºçš„é€šä¿¡ã€‚

## 14.1 è®¡ç®—æœºç½‘ç»œå…¥é—¨

å½“å‰èŠ‚çš„çŸ¥è¯†ç‚¹åªæ˜¯ä¸€ä¸ªæ¦‚è¿°ï¼Œæ›´å…·ä½“ã€è¯¦ç»†çš„å†…å®¹æ”¾åœ¨ è®¡ç®—æœºç½‘ç»œ ä¸­ã€‚

### 14.1.1 è½¯ä»¶ç»“æ„

+ **C/Sç»“æ„**ï¼ˆClient/Serverç»“æ„ï¼‰ï¼šæŒ‡å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç»“æ„ï¼Œå¸¸è§ç¨‹åºæœ‰QQã€è¿…é›·ç­‰è½¯ä»¶ã€‚
+ **B/Sç»“æ„**ï¼ˆBrowser/Serverç»“æ„ï¼‰ï¼šæŒ‡æµè§ˆå™¨ä¸æœåŠ¡å™¨ç»“æ„ã€‚

ä¸¤ç§æ¶æ„å„æœ‰ä¼˜åŠ¿ï¼Œæ— è®ºå“ªç§æ¶æ„ï¼Œéƒ½ç¦»ä¸å¼€ç½‘ç»œçš„æ”¯æŒã€‚**ç½‘ç»œç¼–ç¨‹**ï¼Œå°±æ˜¯åœ¨ä¸€å®šçš„åè®®ä¸‹ï¼Œå®ç°ä¸¤å°è®¡ç®—æœºçš„é€šä¿¡çš„ç¨‹åºã€‚

### 14.1.2 ç½‘ç»œé€šä¿¡åè®®

+ ç½‘ç»œé€šä¿¡åè®®ï¼šåªæœ‰éµå®ˆè¿™äº›è§„åˆ™ï¼Œè®¡ç®—æœºä¹‹é—´æ‰èƒ½è¿›è¡Œé€šä¿¡ã€‚åè®®ä¸­å¯¹æ•°æ®çš„ä¼ è¾“æ ¼å¼ã€ä¼ è¾“é€Ÿç‡ã€ä¼ è¾“æ­¥éª¤ç­‰åšäº†ç»Ÿä¸€è§„å®šï¼Œé€šä¿¡åŒæ–¹å¿…é¡»åŒæ—¶éµå®ˆï¼Œæœ€ç»ˆå®Œæˆæ•°æ®äº¤æ¢ã€‚

+ **TCP/IP**ï¼ˆ TCP/IP åè®®**æ—** çš„ç®€ç§°ï¼‰ï¼šä¼ è¾“æ§åˆ¶åè®®/ç½‘é™…åè®®ï¼ˆTransmission Control Protocol / Internet Protocolï¼‰ï¼Œæ˜¯ç½‘ç»œé€šä¿¡æ¨¡å‹ï¼Œä»¥åŠæ•´ä¸ªç½‘ç»œä¼ è¾“åè®®å®¶æ—ï¼Œä¸ºç½‘é™…ç½‘ç»œçš„åŸºç¡€é€šä¿¡æ¶æ„ã€‚å®ƒå°†è½¯ä»¶é€šä¿¡è¿‡ç¨‹æŠ½è±¡åŒ–ä¸º**å››ä¸ªæŠ½è±¡å±‚**ï¼Œé‡‡å–åè®®å †æ ˆçš„æ–¹å¼ï¼Œåˆ†åˆ«å®ç°å‡ºä¸åŒé€šä¿¡åè®®ã€‚è¯¥åè®®å®¶æ—çš„ä¸¤ä¸ªæ ¸å¿ƒåè®®ã€æœ€å…·ä»£è¡¨æ€§çš„åè®®ä¸ºï¼š**TCP**ï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å’Œ**IP**ï¼ˆç½‘é™…åè®®ï¼‰ã€‚

  <img src="https://gitee.com/j__strawhat/MyImages/raw/master/20201121201210.png"/>

### 14.1.3 åè®®åˆ†ç±»

`java.net`åŒ…ä¸­åŒ…å«çš„ç±»å’Œæ¥å£ï¼Œæä¾›ä½å±‚æ¬¡çš„é€šä¿¡ç»†èŠ‚ã€‚è¯¥åŒ…ä¸­æä¾›äº†ä¸¤ç§å¸¸è§çš„ç½‘ç»œåè®®çš„æ”¯æŒï¼š

+ **UDP**ï¼šç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUser Datagram Protocolï¼‰ã€‚UDPåè®®æ˜¯ä¸€ä¸ªé¢å‘æ— è¿æ¥çš„åè®®ã€‚ä¼ è¾“æ•°æ®æ—¶ï¼Œ**ä¸éœ€å»ºç«‹è¿æ¥**ï¼Œä¸ç®¡å¯¹æ–¹ç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼Œç›´æ¥å°†æ•°æ®ã€æ•°æ®æºå’Œç›®çš„åœ°éƒ½å°è£…åœ¨æ•°æ®åŒ…ä¸­ï¼Œç›´æ¥å‘é€ã€‚æ¯ä¸ªæ•°æ®åŒ…çš„å¤§å°é™åˆ¶åœ¨$64k$ä»¥å†…ã€‚ç”±äºæ— è¿æ¥ï¼Œæ•…ä¼ è¾“é€Ÿåº¦å¿«ï¼Œä½†å®¹æ˜“ä¸¢å¤±æ•°æ®ï¼Œæ—¥å¸¸åº”ç”¨äºè§†é¢‘ä¼šè®®ã€QQèŠå¤©ç­‰ã€‚

+ **TCP**ï¼šä¼ è¾“æ§åˆ¶åè®®ï¼ˆTransmission Control Protocolï¼‰ã€‚TCPåè®®æ˜¯**é¢å‘è¿æ¥**çš„é€šä¿¡åè®®ï¼Œå³ä¼ è¾“æ•°æ®ä¹‹å‰ï¼Œåœ¨å‘é€ç«¯å’Œæ¥æ”¶ç«¯**å»ºç«‹é€»è¾‘è¿æ¥**ï¼Œç„¶åå†ä¼ è¾“æ•°æ®ï¼Œå®ƒæä¾›äº†ä¸¤å°è®¡ç®—æœºä¹‹é—´å¯é æ— å·®é”™çš„æ•°æ®ä¼ è¾“ã€‚TCPåè®®ä¸­ï¼Œåœ¨å‘é€æ•°æ®çš„å‡†å¤‡é˜¶æ®µï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„ä¸‰æ¬¡äº¤äº’ï¼Œç§°ä¸º**ä¸‰æ¬¡æ¡æ‰‹**ï¼Œä»¥ä¿è¯è¿æ¥çš„å¯é ã€‚

  + ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œç­‰å¾…æœåŠ¡å™¨ç¡®è®¤ã€‚
  + ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯å›é€ä¸€ä¸ªå“åº”ï¼Œé€šçŸ¥å®¢æˆ·ç«¯æ”¶åˆ°è¿æ¥è¯·æ±‚ã€‚
  + ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å†æ¬¡å‘æœåŠ¡å™¨ç«¯å‘é€ç¡®è®¤ä¿¡æ¯ï¼Œç¡®è®¤è¿æ¥ã€‚

  å½“å®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿æ¥å»ºç«‹åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å°±å¯ä»¥å¼€å§‹è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œç”±äºè¿™ç§é¢å‘è¿æ¥çš„ç‰¹æ€§ï¼ŒTCPåè®®å¯ä»¥ä¿è¯ä¼ è¾“æ•°æ®çš„å®‰å…¨ï¼Œæ•…åº”ç”¨ååˆ†å¹¿æ³›ï¼Œä¾‹å¦‚ä¸‹è½½æ–‡ä»¶ã€æµè§ˆç½‘é¡µç­‰ã€‚

### 14.1.4 ç½‘ç»œç¼–ç¨‹ä¸‰è¦ç´ 

åˆ©ç”¨**åè®®**+**IPåœ°å€**+**ç«¯å£å·** ä¸‰å…ƒç»„ï¼Œå³å¯æ ‡è¯†ç½‘ç»œä¸­çš„è¿›ç¨‹ã€‚è€Œè¿›ç¨‹é—´çš„é€šä¿¡å³å¯åˆ©ç”¨è¯¥æ ‡è¯†ä¸å…¶ä»–è¿›ç¨‹è¿›è¡Œäº¤äº’ã€‚

1. **åè®®**
   
   å®šä¹‰é€šä¿¡è§„åˆ™ã€‚

   > IPåœ°å€å¯ä»¥å”¯ä¸€æ ‡è¯†ç½‘ç»œä¸­çš„**è®¾å¤‡**ï¼Œç«¯å£å·å¯ä»¥å”¯ä¸€æ ‡è¯†è®¾å¤‡ä¸­çš„**è¿›ç¨‹**ï¼ˆåº”ç”¨ç¨‹åºï¼‰ã€‚

2. **IPåœ°å€**

   IP æŒ‡äº’è”ç½‘åè®®åœ°å€ï¼ˆInternet Protocol Addressï¼‰ï¼Œå®ƒç”¨æ¥ç»™ä¸€ä¸ªç½‘ç»œä¸­çš„è®¡ç®—æœºè®¾å¤‡åšå”¯ä¸€çš„ç¼–å·ã€‚è€ŒIPåœ°å€æœ‰å¦‚ä¸‹åˆ†ç±»ï¼š

   + IPv4ï¼šä½¿ç”¨32ä½åœ°å€ï¼ˆ4å­—èŠ‚ï¼‰ï¼Œæ•…åœ°å€ç©ºé—´åªæœ‰$2^{32}$ä¸ªåœ°å€ã€‚é€šå¸¸é‡‡ç”¨ç‚¹åˆ†åè¿›åˆ¶çš„æ ¼å¼ï¼š`a.b.c.d`ï¼Œå…¶ä¸­`a`ã€`b`ã€`c`ã€`d`å‡ä¸º0~255ä¹‹é—´çš„**åè¿›åˆ¶**æ•´æ•°å¹¶ç”¨`.`åˆ†å¼€ï¼Œå¦‚`192.168.56.100`ã€‚
   + IPv6ï¼šä½¿ç”¨128ä½åœ°å€ï¼Œæ•…åœ°å€ç©ºé—´æ”¯æŒ$2^{128}(=16^{32})$ä¸ªåœ°å€ã€‚å®ƒå¯ä»¥åˆ†ä¸º8ç»„ï¼Œç”¨`:`è¿›è¡Œåˆ†ç»„ï¼Œæ¯ç»„ä»¥4ä½åå…­è¿›åˆ¶æ–¹å¼è¡¨ç¤ºï¼Œå¦‚` ABCD:EF01:2345:6789:ABCD:EF01:2345:6789`

   å¸¸ç”¨å‘½ä»¤æœ‰ï¼š

   + æŸ¥çœ‹æœ¬æœºIPåœ°å€ï¼Œåœ¨æ§åˆ¶å°è¾“å…¥ï¼š`ipconfig` æˆ–è€… é€šè¿‡æ§åˆ¶é¢æ¿

     <img src="https://gitee.com/j__strawhat/MyImages/raw/master/20210220224143.png"/>

   + æ£€æŸ¥ç½‘ç»œæ˜¯å¦è¿é€šï¼Œåœ¨æ§åˆ¶å°è¾“å…¥ï¼š`ping IPåœ°å€`ï¼ˆå¦‚`ping 220.181.57.216`ï¼‰

3. **ç«¯å£å·**

   ç«¯å£å·ï¼Œæ˜¯ä¸€ä¸ªé€»è¾‘ç«¯å£ã€‚å®ƒç”¨**ä¸¤ä¸ªå­—èŠ‚**è¡¨ç¤ºçš„æ•´æ•°ï¼Œå…¶å–æ•´èŒƒå›´ä¸º[$0, 2^8\times2^8$]ã€‚å…¶ä¸­[$0,1023$]ä¹‹é—´çš„ç«¯å£å·ç”¨äºä¸€äº›çŸ¥åçš„ç½‘ç»œæœåŠ¡å’Œåº”ç”¨ã€‚$1024$ä»¥ä¸Šçš„ç«¯å£åˆ™ç”¨äºæ™®é€šçš„åº”ç”¨ç¨‹åºã€‚å½“ç½‘ç»œè½¯ä»¶ä¸€æ‰“å¼€ï¼Œæ“ä½œç³»ç»Ÿä¾¿ä¼šä¸ºè¯¥ç½‘ç»œè½¯ä»¶åˆ†é…ä¸€ä¸ªéšæœºçš„ç«¯å£å·ã€‚è‹¥ç«¯å£å·è¢«å¦å¤–ä¸€ä¸ªæœåŠ¡æˆ–åº”ç”¨æ‰€å ç”¨ï¼Œä¼šå¯¼è‡´å½“å‰ç¨‹åºå¯åŠ¨å¤±è´¥ã€‚

   > å¸¸ç”¨ç«¯å£å·æœ‰ï¼š
   >
   > 1. 80ç«¯å£ï¼šç½‘ç»œç«¯å£
   > 2. æ•°æ®åº“ï¼šmysqlï¼š3306ï¼›oracleï¼š1521
   > 3. TomcatæœåŠ¡å™¨ï¼š8080

> ä¸¾ä¾‹ï¼šè‹¥æˆ‘è¦å’Œå¼ ä¸‰è¯´è¯ï¼Œæˆ‘éœ€è¦å¼ ä¸‰çš„åœ°å€æ¥æ‰¾åˆ°ä»–ï¼ˆç›¸å½“äºé€šè¿‡IPæ‰¾åˆ°æŒ‡å®šè®¡ç®—æœºï¼‰ï¼›æ¥ç€æˆ‘è¦ä¸å¼ ä¸‰çš„è¯´è¯ï¼Œè€Œä»–ç”¨è€³æœµå¬æˆ‘è¯´è¯ï¼ˆç›¸å½“äºç”¨ç‰¹å®šç«¯å£æ¥æ”¶ï¼‰ï¼›è€Œæˆ‘ä»¬ä¹‹é—´å¯¹è¯çš„è¯­è¨€ï¼Œéœ€è¦åšå¥½çº¦å®šï¼Œå½¼æ­¤éƒ½èƒ½å¬æ‡‚ï¼ˆåè®®æ‰€èµ·çš„ä½œç”¨ï¼‰ã€‚

## 14.2 TCPé€šä¿¡ç¨‹åº

### 14.2.1 æ¦‚è¿°

TCPé€šä¿¡èƒ½å®ç°ä¸¤æ¡è®¡ç®—æœºä¹‹é—´çš„æ•°æ®äº¤äº’ï¼Œé€šä¿¡çš„ä¸¤ç«¯ï¼Œè¦ä¸¥æ ¼åŒºåˆ†å®¢æˆ·ç«¯ï¼ˆClientï¼‰ä¸æœåŠ¡ç«¯ï¼ˆServerï¼‰ã€‚

ä¸¤ç«¯é€šä¿¡æ—¶æ­¥éª¤ï¼š

1. æœåŠ¡ç«¯ç¨‹åºï¼Œéœ€äº‹**å…ˆå¯åŠ¨**ï¼ä½†æœåŠ¡ç«¯ä¸èƒ½å¤Ÿä¸»åŠ¨è¿æ¥å®¢æˆ·ç«¯ï¼Œéœ€ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ã€‚è¿™ä¸ªè¿æ¥å½“ä¸­åŒ…å«IOå¯¹è±¡ï¼ˆå­—èŠ‚æµå¯¹è±¡ï¼‰ã€‚
2. å®¢æˆ·ç«¯**ä¸»åŠ¨è¿æ¥**æœåŠ¡å™¨ç«¯ï¼Œè¿æ¥æˆåŠŸåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å¯ä½¿ç”¨IOå¯¹è±¡è¿›è¡Œé€šä¿¡äº†ã€‚ä¸€ä¸ªæ•°æ®çš„äº¤äº’åˆ™éœ€è¦4ä¸ªIOæµå¯¹è±¡

åœ¨Javaä¸­ï¼Œæä¾›ä¸¤ä¸ªç±»ç”¨äºå®ç°TCPé€šä¿¡ç¨‹åºï¼š

1. å®¢æˆ·ç«¯ï¼šç”¨`java.net.Socket` ç±»è¡¨ç¤ºã€‚åˆ›å»º `Socket` å¯¹è±¡ï¼Œå‘æœåŠ¡ç«¯å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œç­‰åˆ°æœåŠ¡ç«¯å“åº”è¯·æ±‚åï¼Œä¸¤è€…å»ºç«‹è¿æ¥å¼€å§‹é€šä¿¡ã€‚

2. æœåŠ¡ç«¯ï¼šç”¨`java.net.ServerSocket` ç±»è¡¨ç¤ºã€‚åˆ›å»º `ServerSocket` å¯¹è±¡ï¼Œç›¸å½“äºå¼€å¯ä¸€ä¸ªæœåŠ¡ï¼Œå¹¶ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ã€‚

   æ³¨æ„ï¼ŒæœåŠ¡ç«¯æ²¡æœ‰IOæµï¼Œå®ƒä½¿ç”¨æ¯ä¸ªå®¢æˆ·ç«¯`Socket`ä¸­æä¾›çš„IOæµå’Œå®¢æˆ·ç«¯è¿›è¡Œäº¤äº’ï¼š

   + æœåŠ¡ç«¯ä½¿ç”¨å®¢æˆ·ç«¯çš„å­—èŠ‚è¾“å…¥æµè¯»å…¥å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ã€‚
   + æœåŠ¡ç«¯ä½¿ç”¨å®¢æˆ·ç«¯çš„å­—èŠ‚è¾“å‡ºæµç»™å®¢æˆ·ç«¯å›å†™æ•°æ®ã€‚

### 14.2.2 Socket ç±»

ä½¿ç”¨`Socket` ç±»ï¼Œå®ç°å®¢æˆ·ç«¯å¥—æ¥å­—ï¼ˆå¥—æ¥å­—*Socket*ï¼Œå¯ä»¥ç†è§£ä¸ºæ’åº§ï¼Œå®ƒåŒ…å«äº†**IPåœ°å€å’Œç«¯å£å·**çš„ç½‘ç»œå•ä½ï¼‰ã€‚

<img src="https://gitee.com/j__strawhat/MyImages/raw/master/20201121214953.png"/>

æ„é€ æ–¹æ³•ï¼š

+ `public Socket(String host, int port)`ï¼šåˆ›å»ºå¥—æ¥å­—ï¼ˆSocketï¼‰å¯¹è±¡ï¼Œå¹¶å°†å…¶è¿æ¥åˆ°æŒ‡å®šä¸»æœºä¸Šçš„æŒ‡å®šç«¯å£å·ã€‚

  å‚æ•°ï¼š

  + `String host`ï¼šæœåŠ¡å™¨ä¸»æœºçš„åç§°/**æœåŠ¡å™¨çš„IPåœ°å€**ã€‚
  + `int port`ï¼šæœåŠ¡å™¨çš„ç«¯å£å·ã€‚

  >  å¦‚æœæŒ‡å®šçš„ `host` æ˜¯ `null` ï¼Œåˆ™ç›¸å½“äºæŒ‡å®šåœ°å€ä¸ºå›é€åœ°å€ã€‚å›é€åœ°å€(127.x.x.x) æ˜¯æœ¬æœºå›é€åœ°å€ï¼ˆLoopback Addressï¼‰ï¼Œä¸»è¦ç”¨äºç½‘ç»œè½¯ä»¶æµ‹è¯•ä»¥åŠæœ¬ åœ°æœºè¿›ç¨‹é—´é€šä¿¡ï¼Œæ— è®ºä»€ä¹ˆç¨‹åºï¼Œä¸€æ—¦ä½¿ç”¨å›é€åœ°å€å‘é€æ•°æ®ï¼Œç«‹å³è¿”å›ï¼Œä¸è¿›è¡Œä»»ä½•ç½‘ç»œä¼ è¾“ã€‚

æˆå‘˜æ–¹æ³•

+ `public InputStream getInputStream()`ï¼šè¿”å›æ­¤å¥—æ¥å­—çš„è¾“å…¥æµã€‚è‹¥æ­¤`Scoket`å…·æœ‰ç›¸å…³è”çš„é€šé“ï¼Œåˆ™ç”Ÿæˆçš„`InputStream`çš„æ‰€æœ‰æ“ä½œä¹Ÿå…³è”è¯¥é€šé“ã€‚å…³é—­ç”Ÿæˆçš„`InputStream`ä¹Ÿå°†å…³é—­ç›¸å…³çš„`Socket`ã€‚
+ `public OutputStream getOutputStream()`ï¼šè¿”å›æ­¤å¥—æ¥å­—çš„è¾“å‡ºæµã€‚ä¸ä¸ŠåŒç†ã€‚
+ `public void close()`ï¼šå…³é—­æ­¤å¥—æ¥å­—ã€‚ä¸€ä¸ª`Socket`è¢«å…³é—­ï¼Œåˆ™ä¸å¯å†è¢«ä½¿ç”¨
+ `public void shutdownOutput()`ï¼šç¦ç”¨æ­¤å¥—æ¥å­—çš„è¾“å‡ºæµã€‚ä»»ä½•å…ˆå‰å†™å‡ºçš„æ•°æ®å°†è¢«å‘é€ï¼Œéšåç»ˆæ­¢è¾“å‡ºæµã€‚

### 14.2.3 ServerSocket ç±»

`ServerSocket`ç±»ï¼Œå®ç°äº†æœåŠ¡å™¨å¥—æ¥å­—ï¼Œè¯¥å¯¹è±¡ç­‰å¾…é€šè¿‡ç½‘ç»œçš„è¯·æ±‚ã€‚

æ„é€ æ–¹æ³•ï¼š

+ `public ServerSocket(int port)`ï¼šåˆ›å»ºç»‘å®šåˆ°ç‰¹å®šç«¯å£`port`çš„æœåŠ¡å™¨å¥—æ¥å­—

æˆå‘˜æ–¹æ³•ï¼š

+ `public Socket accept()`ï¼šä¾¦å¬å¹¶æ¥å—è¿æ¥ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„`Socket`å¯¹è±¡ï¼Œç”¨äºç»™å®¢æˆ·ç«¯å®ç°é€šä¿¡ï¼Œè¯¥æ–¹æ³•ä¼šä¸€ç›´é˜»å¡åˆ°å»ºç«‹è¿æ¥ã€‚ç”±äºæœåŠ¡ç«¯å¿…é¡»æ˜ç¡®æ˜¯å“ªä¸ªå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œæ•…å¯ä½¿ç”¨è¯¥æ–¹æ³•ä»¥è·å–åˆ°å‘é€è¯·æ±‚çš„å®¢æˆ·ç«¯å¯¹è±¡`Socket`ã€‚

### 14.2.4 ç®€å•çš„TCPç½‘ç»œç¨‹åº

TCPé€šä¿¡æ­¥éª¤ï¼š

<img src="https://gitee.com/j__strawhat/MyImages/raw/master/5_ç®€å•é€šä¿¡.jpg"/>

1. ã€æœåŠ¡ç«¯ã€‘å¯åŠ¨ï¼Œåˆ›å»º`ServerSocket`å¯¹è±¡ï¼Œç­‰å¾…è¿æ¥ã€‚

2. ã€å®¢æˆ·ç«¯ã€‘å¯åŠ¨ï¼Œåˆ›å»º`Socket`å¯¹è±¡ï¼Œè¯·æ±‚è¿æ¥ã€‚

3. ã€æœåŠ¡ç«¯ã€‘æ¥æ”¶è¿æ¥ï¼Œè°ƒç”¨`accept()`æ–¹æ³•ï¼Œå¹¶è¿”å›ä¸€ä¸ª`Socket`å¯¹è±¡ã€‚

4. ã€å®¢æˆ·ç«¯ã€‘`Socket`å¯¹è±¡ï¼Œè·å–`OutputStream`ï¼Œå‘æœåŠ¡ç«¯å†™å‡ºæ•°æ®ã€‚

5. ã€æœåŠ¡ç«¯ã€‘`Socket`å¯¹è±¡ï¼Œè·å–`InputStream`ï¼Œè¯»å…¥å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ã€‚

   > åˆ°æ­¤ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ•°æ®æˆåŠŸï¼
   >
   > è‡³æ­¤ï¼ŒæœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å›å†™æ•°æ®

6. ã€æœåŠ¡ç«¯ã€‘`Socket`å¯¹è±¡ï¼Œè·å–`OutputStream`ï¼Œå‘å®¢æˆ·ç«¯å›å†™æ•°æ®ã€‚

7. ã€å®¢æˆ·ç«¯ã€‘`Socket`å¯¹è±¡ï¼Œè·å–`InputStream`ï¼Œè§£æå›å†™æ•°æ®ã€‚

8. ã€å®¢æˆ·ç«¯ã€‘é‡Šæ”¾èµ„æºï¼Œæ–­å¼€è¿æ¥ã€‚

æœåŠ¡ç«¯å®ç°ï¼š

```java
public class ServerTCP {
    public static void main(String[] args) throws IOException {
        System.out.println("æœåŠ¡ç«¯å¯åŠ¨ï¼Œç­‰å¾…è¿æ¥ä¸­....");
        ServerSocket ss = new ServerSocket(6666); //1.åˆ›å»ºServerSocketå¯¹è±¡ï¼Œç»‘å®šç«¯å£ï¼Œå¼€å§‹ç­‰å¾…è¿æ¥
        Socket server = ss.accept(); //2.è°ƒç”¨acceptæ–¹æ³•ï¼Œä»¥è·å–å‘é€è¯·æ±‚çš„å®¢æˆ·ç«¯Socket
        InputStream is = server.getInputStream(); //3.é€šè¿‡Socketå¯¹è±¡è·å–è¾“å…¥æµï¼Œè¯»å…¥å®¢æˆ·ç«¯å‘é€çš„æ•°æ®
		//4.ä¸€æ¬¡æ€§è¯»å…¥æ•°æ®
        byte[] arr = new byte[1024];
        int len = is.read(arr); //è¯»å…¥è‡³å­—èŠ‚æ•°ç»„ä¸­
        String msg = new String(arr, 0, len); //è§£ææ•°ç»„ï¼Œæ‰“å°å­—ç¬¦ä¸²ä¿¡æ¯
        System.out.println(msg); //æ‰“å°å­—ç¬¦ä¸²ä¿¡æ¯ï¼Œä¾›æµ‹è¯•

        /* ---------------å›å†™æ•°æ®--------------- */
        OutputStream os = server.getOutputStream(); //5.é€šè¿‡Socketè·å–è¾“å‡ºæµ
        os.write("Hey man, I am good!".getBytes()); //6.å›å†™æ•°æ®è‡³å®¢æˆ·ç«¯
		
        os.close();
        is.close();
        server.close();
    }
}
```

å®¢æˆ·ç«¯å®ç°ï¼š

```java
public class ClientTCP {
    public static void main(String[] args) throws IOException {
        System.out.println("å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼");
        Socket client = new Socket("localhost", 6666); //1.ç¡®å®šè¿æ¥è‡³å“ªä¸ªæœåŠ¡ç«¯
        OutputStream os = client.getOutputStream(); //2.è·å–è¾“å‡ºæµå¯¹è±¡
        os.write("How do you do, TCP? I am coming!".getBytes()); //3.å†™å‡ºæ•°æ®è‡³æœåŠ¡ç«¯

        /* ---------------è§£æå›å†™--------------- */
        InputStream in = client.getInputStream(); //4.è·å–è¾“å…¥æµå¯¹è±¡
        //5.è¯»å…¥å›å†™çš„æ•°æ®
        byte[] arr = new byte[100];
        int len = in.read(arr);
        System.out.println(new String(arr, 0, len)); //æ‰“å°æœåŠ¡ç«¯å›å†™çš„æ•°æ®

        in.close();
        os.close();
        client.close();
    }
}
```

å¯åŠ¨æ—¶ï¼Œåº”è¯¥å…ˆè¿è¡ŒæœåŠ¡ç«¯ï¼Œå†è¿è¡Œå®¢æˆ·ç«¯ï¼ˆæ‰‹é€Ÿè¦å¿«ï¼‰ï¼Œé¡ºåºé¢ å€’ä¼šå¯¼è‡´æŠ›å‡ºå¼‚å¸¸

`ServerTCP`è¿è¡Œç»“æœï¼š

<img src="https://gitee.com/j__strawhat/MyImages/raw/master/20201121222818.png" width = "400"/>

`ClientTCP`è¿è¡Œç»“æœï¼š

<img src="https://gitee.com/j__strawhat/MyImages/raw/master/20201121222905.png" width = "400"/>

## 14.3 ç»¼åˆæ¡ˆä¾‹

### 14.3.1 æ–‡ä»¶ä¸Šä¼ 

<img src="https://gitee.com/j__strawhat/MyImages/raw/master/20210125104522.png"/>

> â‘ ã€å®¢æˆ·ç«¯ã€‘è¾“å…¥æµï¼Œä»æœ¬åœ°ç¡¬ç›˜è¯»å…¥æ–‡ä»¶æ•°æ®åˆ°ç¨‹åºä¸­ï¼›
>
> â‘¡ã€å®¢æˆ·ç«¯ã€‘è¾“å‡ºæµï¼Œå†™å‡ºæ–‡ä»¶æ•°æ®åˆ°æœåŠ¡ç«¯ï¼›
>
> â‘¢ã€æœåŠ¡ç«¯ã€‘è¾“å…¥æµï¼Œè¯»å…¥æ–‡ä»¶æ•°æ®åˆ°æœåŠ¡ç«¯ç¨‹åºï¼›
>
> â‘£ã€æœåŠ¡ç«¯ã€‘è¾“å‡ºæµï¼Œå†™å‡ºæ–‡ä»¶æ•°æ®åˆ°æœåŠ¡å™¨ç¡¬ç›˜ä¸­ã€‚

ä¸€ã€åˆæ­¥å®ç°

æœåŠ¡ç«¯*åˆæ­¥*ä»£ç å®ç°ï¼š

```java
import java.io.*;
import java.net.ServerSocket;
import java.net.Socket;

public class FileUpload_Server {
    public static void main(String[] args) throws IOException {
        System.out.println("æœåŠ¡å™¨å·²ç»å¯åŠ¨....");
        ServerSocket serverSocket = new ServerSocket(8888); //1.åˆ›å»ºæœåŠ¡ç«¯ServerSocket
        Socket apt = serverSocket.accept(); //2.å»ºç«‹è¿æ¥
        //3.åˆ›å»ºæµå¯¹è±¡
        BufferedInputStream bis = new BufferedInputStream(apt.getInputStream()); //è·å–è¾“å…¥æµï¼Œè¯»å…¥æ–‡ä»¶æ•°æ®
        File file = new File("D:\\uploadbyJava");
        //å‡å®šDç›˜å³ä¸ºæœåŠ¡å™¨ç¡¬ç›˜
        if(!file.exists()) file.mkdir(); //ä¸å­˜åœ¨è¯¥æ–‡ä»¶å¤¹åˆ™åˆ›å»ºå®ƒ
        BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream(file + "\\copy.jpg"));//åˆ›å»ºè¾“å‡ºæµï¼Œå†™å‡ºåˆ°æœåŠ¡å™¨æœ¬åœ°
        //4.è¯»å†™æ•°æ®
        byte[] b = new byte[1024 * 8];
        int len = 0;
        while((len = bis.read(b)) != -1){
            bos.write(b, 0, len);
        }
        //5.å…³é—­èµ„æº
        bos.close();
        bis.close();
        apt.close();
        System.out.println("ä¸Šä¼ çš„æ–‡ä»¶å·²ç»ä¿å­˜ï¼");
    }
}
```

å®¢æˆ·ç«¯*åˆæ­¥*ä»£ç å®ç°ï¼š

```java
import java.io.*;
import java.net.Socket;

public class FileUpload_Client {
    public static void main(String[] args) throws IOException {
        //1.åˆ›å»ºæµå¯¹è±¡
        BufferedInputStream bis = new BufferedInputStream(new FileInputStream("E:\\wall.jpg"));//1.1 åˆ›å»ºè¾“å…¥æµï¼Œè¯»å…¥æœ¬åœ°ç¡¬ç›˜çš„æ–‡ä»¶
        Socket socket = new Socket("127.0.0.1", 8888);
        BufferedOutputStream bos = new BufferedOutputStream(socket.getOutputStream()); //åˆ›å»ºè¾“å‡ºæµï¼Œå†™å‡ºåˆ°æœåŠ¡ç«¯
        //2.è¯»å†™æ•°æ®
        int len = 0;
        byte[] b = new byte[1024 * 8];
        while((len = bis.read(b)) != -1){
            bos.write(b, 0, len);
            bos.flush(); 
            /* æ³¨æ„ï¼flush()åœ¨æ­¤å¤„ååˆ†é‡è¦ï¼å®ƒæ—¢èƒ½å¤Ÿä¿è¯å°†ç¼“å†²åŒºåˆ·æ–°ï¼Œåˆèƒ½å¤Ÿåœ¨ä¸‹ä¸€è½®å¾ªç¯ä¸­ç»§ç»­ä½¿ç”¨ã€‚*/            
        }
        System.out.println("æ–‡ä»¶å‘é€å®Œæ¯•!");
        //3.é‡Šæ”¾èµ„æº
        bos.close();
        socket.close();
        bis.close();
        System.out.println("æ–‡ä»¶ä¸Šä¼ å®Œæ¯•!");
    }
}
```

> å®¢æˆ·ç«¯çŸ¥é“è‡ªå·±çš„æ–‡ä»¶ä»€ä¹ˆæ—¶å€™è¯»å–å®Œæ¯•ï¼Œå¯ä»¥è‡ªå·±åœæ­¢ã€‚å¦‚æœä¸ä½¿ç”¨ `flush()` æˆ–è€…æ˜¯è§†é¢‘ä¸­ `shutdownOutput()`ï¼ŒæœåŠ¡å™¨ä¸èƒ½å¤Ÿæ¥æ”¶åˆ°æ–‡ä»¶ç»“æŸçš„æ ‡è®°ï¼Œä¹Ÿå³æ— æ³•çŸ¥é“ä½•æ—¶åœæ­¢ï¼Œä¼šä¸æ–­åœ°ç­‰å¾…ç€ï¼ˆæ­»å¾ªç¯ï¼‰æ¥æ”¶å®¢æˆ·ç«¯`read()`ä¸­çš„å†…å®¹ï¼Œè¿›å…¥**é˜»å¡**çŠ¶æ€ã€‚

äºŒã€ä¼˜åŒ–åˆ†æ

1. å…³äºæ–‡ä»¶åç§°å†™æ­»çš„é—®é¢˜

   ä¸ºäº†åœ¨æœåŠ¡å™¨ç¡¬ç›˜ä¸­ä¿å­˜å¤šä¸ªæ–‡ä»¶ï¼Œä¸åº”å°†æ–‡ä»¶åç§°å†™æ­»ï¼Œå¦‚ `xxx.jpg`ã€‚å¯ä»¥ä½¿ç”¨ç³»ç»Ÿæ—¶é—´+éšæœºæ•°æ¥è¿›è¡Œå‘½åã€‚

   ```java
   String fileName = System.currentTimeMillis() + new Random().nextInt(999999)+".jpg";//æ–‡ä»¶åç§°
   FileOutputStream fis = new FileOutputStream(file + 
   "\\" + fileName); // æ–‡ä»¶è·¯å¾„
   BufferedOutputStream bos = new BufferedOutputStream(fis);
   ```

2. å…³äºå¾ªç¯æ¥æ”¶çš„é—®é¢˜

   æœåŠ¡ç«¯å¦‚æœåªä¿å­˜ä¸€ä¸ªæ–‡ä»¶å°±å…³é—­çš„è¯ï¼Œç”¨æˆ·æ— æ³•å†è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œä¸ç¬¦åˆå®é™…ã€‚å¯ä½¿ç”¨å¾ªç¯è¿›è¡Œæ”¹è¿›ï¼Œä½¿å¾—æœåŠ¡å™¨ä¸€ç›´å¤„äºç›‘å¬çŠ¶æ€ï¼Œä¸æ–­åœ°æ¥æ”¶ä¸åŒç”¨æˆ·çš„æ–‡ä»¶ï¼ˆæ³¨æ„ï¼Œå®ƒä¸åŒäºä¸Šé¢æ‰€è¿°çš„é˜»å¡çŠ¶æ€ï¼‰

   > è¿è¡Œçš„æ—¶å€™ï¼Œä¸éœ€è¦æ‰‹é€Ÿäº†ğŸ˜‚

   ```java
   while(true){ // æ¯æ¬¡æ¥æ”¶æ–°çš„è¿æ¥,åˆ›å»ºä¸€ä¸ªSocket
       Socket accept = serverSocket.accept();
       ......
   }
   ```

3. å…³äºæ•ˆç‡çš„é—®é¢˜

   æœåŠ¡ç«¯ï¼Œåœ¨æ¥æ”¶å¤§æ–‡ä»¶æ—¶ï¼Œå¯èƒ½è€—è´¹å‡ ç§’é’Ÿçš„æ—¶é—´ï¼Œæ­¤æ—¶ä¸èƒ½æ¥æ”¶å…¶ä»–ç”¨æˆ·ä¸Šä¼ ï¼Œæ‰€ä»¥ï¼Œä½¿ç”¨å¤šçº¿ç¨‹æŠ€æœ¯ä¼˜åŒ–ï¼Œä»£ç å¦‚ä¸‹ï¼š

   ```java
   while(true){
       Socket apt = serverSocket.accept();
       new Thread(() -> {
           //socketå¯¹è±¡äº¤ç»™å­çº¿ç¨‹å¤„ç†è¿›è¡Œè¯»å†™æ“ä½œï¼ŒRunnableæ¥å£ä¸­åªæœ‰ä¸€ä¸ªrunæ–¹æ³•ï¼Œä½¿ç”¨lambdaè¡¨è¾¾å¼ç®€åŒ–æ ¼å¼
           InputStream bis = accept.getInputStream();
           //...
       })
   }
   ```

ä¸‰ã€ä»£ç ä¼˜åŒ–+ä¿¡æ¯å›å†™

æœåŠ¡ç«¯ä»£ç ï¼š

```java
import java.io.*;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.Random;

public class FileUpload_Server {
    public static void main(String[] args) throws IOException {
        File file = new File("D:\\uploadbyJava"); //å‡å®šDç›˜å³ä¸ºæœåŠ¡å™¨ç¡¬ç›˜ï¼Œè®¾ç½®æ–‡ä»¶è·¯å¾„
        if(!file.exists()) file.mkdir(); //ä¸å­˜åœ¨è¯¥æ–‡ä»¶å¤¹åˆ™åˆ›å»ºå®ƒ
        System.out.println("æœåŠ¡å™¨å·²ç»å¯åŠ¨....");
        ServerSocket serverSocket = new ServerSocket(8888); //1.åˆ›å»ºæœåŠ¡ç«¯ServerSocket
		//2.å¾ªç¯æ¥æ”¶ï¼Œå»ºç«‹è¿æ¥
        while(true){
            Socket apt = serverSocket.accept(); 
            String fileName = System.currentTimeMillis() + new Random().nextInt(999999)+".jpg"; //æ–‡ä»¶å
            /* 3.socketå¯¹è±¡äº¤ç»™å­çº¿ç¨‹å¤„ç†,è¿›è¡Œè¯»å†™æ“ä½œ
               Runnableæ¥å£ä¸­,åªæœ‰ä¸€ä¸ªrunæ–¹æ³•,ä½¿ç”¨lambdaè¡¨è¾¾å¼ç®€åŒ–æ ¼å¼
            */
            new Thread(() -> {
                try(
                        BufferedInputStream bis = new BufferedInputStream(apt.getInputStream());//è·å–è¾“å…¥æµå¯¹è±¡
                        FileOutputStream fis = new FileOutputStream(file + "\\" + fileName); // åˆ›å»ºè¾“å‡ºæµå¯¹è±¡ï¼Œç”¨äºå†™å‡ºè‡³æœåŠ¡å™¨æœ¬åœ°
                        BufferedOutputStream bos = new BufferedOutputStream(fis);
                ){ //è¯»å†™æ•°æ®
                    byte[] b = new byte[1024 * 8];
                    int len = 0;
                    while((len = bis.read(b)) != -1){
                        bos.write(b, 0, len);
                    }
					/* 4.ä¿¡æ¯å›å†™ */
                    System.out.println("back....");
                    OutputStream out = apt.getOutputStream();
                    out.write("æ–‡ä»¶ä¸Šä¼ æˆåŠŸè‡³æœåŠ¡å™¨!".getBytes());
                    out.close();
					//å…³é—­èµ„æº
                    apt.close();
                    System.out.println("ä¸Šä¼ çš„æ–‡ä»¶å·²ç»ä¿å­˜!");
                } catch (IOException e){
                    e.printStackTrace();
                }
            }).start(); //åˆ«å¿˜è®°è¿è¡Œè¿›ç¨‹
        }
    }
}
```

å®¢æˆ·ç«¯ä»£ç ï¼š

```java
import java.io.*;
import java.net.Socket;

public class FileUpload_Client {
    public static void main(String[] args) throws IOException {
        //1.åˆ›å»ºæµå¯¹è±¡
        BufferedInputStream bis = new BufferedInputStream(new FileInputStream("E:\\wall.jpg"));//åˆ›å»ºè¾“å…¥æµï¼Œè¯»å…¥æœ¬åœ°ç¡¬ç›˜çš„æ–‡ä»¶
        Socket socket = new Socket("127.0.0.1", 8888);
        BufferedOutputStream bos = new BufferedOutputStream(socket.getOutputStream()); //åˆ›å»ºè¾“å‡ºæµï¼Œå†™å‡ºåˆ°æœåŠ¡ç«¯
        //2.è¯»å†™æ•°æ®
        int len = 0;
        byte[] b = new byte[1024 * 8];
        while((len = bis.read(b)) != -1){
            bos.write(b, 0, len);
            //bos.flush();
        }
        socket.shutdownOutput(); //å…³é—­è¾“å‡ºæµï¼Œé€šçŸ¥æœåŠ¡ç«¯ï¼Œå†™å‡ºæ•°æ®å®Œæ¯•
        System.out.println("æ–‡ä»¶å‘é€å®Œæ¯•!");
		/* 3. è§£æå›å†™ */
        InputStream in = socket.getInputStream();
        byte[] back = new byte[20];
        in.read(back);
        System.out.println(new String(back));
        // 4. é‡Šæ”¾èµ„æº
        in.close();
        socket.close();
        bis.close();
    }
}
```

è¿è¡Œç»“æœï¼š

| æœåŠ¡ç«¯è¿è¡Œçª—å£                                               | å®¢æˆ·ç«¯è¿è¡Œçª—å£                                               | å®é™…è¿è¡Œç»“æœ                                                 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| <img src="https://gitee.com/j__strawhat/MyImages/raw/master/20210125164753.png"/> | <img src="https://gitee.com/j__strawhat/MyImages/raw/master/20210125164849.png"/> | ![image-20210125164904495](https://gitee.com/j__strawhat/MyImages/raw/master/image-20210125164904495.png) |

### 14.3.2 æ¨¡æ‹ŸB/SæœåŠ¡å™¨

æ¨¡æ‹Ÿç½‘ç«™æœåŠ¡å™¨ï¼Œä½¿ç”¨æµè§ˆå™¨æ¥è®¿é—®è‡ªå·±ç¼–å†™çš„æœåŠ¡ç«¯ç¨‹åºï¼ŒæŸ¥çœ‹ç½‘é¡µæ•ˆæœã€‚

è¦ç‚¹ï¼š

1. æˆ‘ä»¬å¯ä»¥å°†é¡µé¢æ•°æ®æ”¾ç½®åˆ°æŸä¸ªwebæ–‡ä»¶å¤¹ä¸­ï¼ŒæœåŠ¡å™¨ç«¯ç¨‹åºå¯åŠ¨æ—¶ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥åœ°å€ï¼š`localhost:ç«¯å£å·/é¡µé¢æ•°æ®æ–‡ä»¶è·¯å¾„`ï¼Œå¦‚ä¸‹å›¾ï¼š

   <img src="https://gitee.com/j__strawhat/MyImages/raw/master/20210125180648.png"/>

2. æœåŠ¡å™¨ç¨‹åºä¸­å­—èŠ‚è¾“å…¥æµå¯è¯»å…¥æµè§ˆå™¨å‘æ¥çš„è¯·æ±‚ä¿¡æ¯ï¼Œç±»ä¼¼äºä¸‹å›¾ï¼š

   <img src="https://gitee.com/j__strawhat/MyImages/raw/master/è¯»å–è®¿é—®ä¿¡æ¯.jpg"/>

   å…¶ä¸­ï¼Œç¬¬ä¸€è¡Œä¸ºæµè§ˆå™¨çš„è¯·æ±‚ä¿¡æ¯ï¼Œè€Œ `/web/index.html` æ­£æ˜¯æµè§ˆå™¨æƒ³è¦è¯·æ±‚çš„æœåŠ¡å™¨ç«¯çš„èµ„æºï¼Œéœ€è¦ç”¨**å­—ç¬¦ä¸²è¿›è¡Œåˆ‡å‰²**è·å–

3. æµè§ˆå™¨åœ¨å¾—åˆ°å“åº”ä¿¡æ¯åï¼Œä¾¿åœ¨é¡µé¢è¿›è¡Œæ•°æ®çš„å±•ç¤ºã€‚

4. æµè§ˆå™¨é‡åˆ°å›¾ç‰‡æ—¶ï¼Œä¼šå¼€å¯ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå•ç‹¬çš„è®¿é—®ï¼Œå› è€Œéœ€è¦åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨çº¿ç¨‹æŠ€æœ¯ã€‚

```java
public class BS_ServerDemo {
    public static void main(String[] args) throws IOException {
        System.out.println("æœåŠ¡ç«¯å¯åŠ¨ï¼Œç­‰å¾…è¿æ¥ä¸­....");
        ServerSocket server = new ServerSocket(8888);
        while(true){
            Socket socket = server.accept();
            new Thread(new Web(socket)).start(); //Webä½œä¸ºtargetï¼ŒThreadå¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡ï¼Œéœ€è¦è°ƒç”¨startå¯åŠ¨çº¿ç¨‹
        }
    }
    static class Web implements Runnable{ //å®ç°Runnableæ¥å£ï¼Œä»¥åˆ›å»ºçº¿ç¨‹
        private Socket socket;
        public Web(Socket socket){
            this.socket = socket;
        }
        public void run(){ //å®šä¹‰Runnableæ¥å£çš„å®ç°ç±»ï¼Œéœ€è¦è¦†å†™è¯¥æ¥å£çš„runæ–¹æ³•
            try{
                BufferedReader readWb = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                //è½¬æ¢æµè¯»å…¥æµè§ˆå™¨è¯·æ±‚çš„ä¿¡æ¯ï¼Œç±»ä¼¼äº"GET, /basic-codes/NewModule/web/index.html, HTTP/1.1"
                String reqst = readWb.readLine();
                String[] arr = reqst.split(" "); //ä»¥ç©ºæ ¼å­—ç¬¦ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå°†ä¸Šé¢çš„ä¿¡æ¯åˆ‡å‰²ï¼Œæˆ‘è¦å–å‡ºå…¶ä¸­çš„è¯·æ±‚èµ„æºçš„è·¯å¾„
                System.out.println(Arrays.toString(arr));
                String realpath = arr[1].substring(1); //å› ä¸ºarr[1]="/basic-codes/NewModule/web/index.html"æœ‰å¤šä½™çš„â€˜/â€™å­—ç¬¦
                System.out.println(realpath);

                FileInputStream fis = new FileInputStream(realpath);
                System.out.println(fis);
                byte[] b= new byte[1024];
                int len = 0;
                OutputStream out = socket.getOutputStream();
                //å­—èŠ‚è¾“å‡ºæµï¼Œæ¥ä¸‹æ¥ä¸‰è¡Œæ˜¯å›ºå®šçš„ï¼Œå°†HTTPåè®®å“åº”å¤´å†™å‡ºç»™å®¢æˆ·ç«¯
                out.write("HTTP/1.1 200 OK\r\n".getBytes());
                out.write("Content-Type:text/html\r\n".getBytes());
                out.write("\r\n".getBytes()); // å¿…é¡»è¦å†™å…¥ç©ºè¡Œ,å¦åˆ™æµè§ˆå™¨ä¸è§£æ
                while((len = fis.read(b)) != -1){ //è¯»å…¥ï¼ˆå®¢æˆ·ç«¯æ‰€è¯·æ±‚çš„ï¼‰èµ„æºæ–‡ä»¶
                    out.write(b, 0, len);
                }
                fis.close();
                out.close();
                readWb.close();
                socket.close();
            } catch (IOException e){
                e.printStackTrace();
            }
        }
    }
}
```



